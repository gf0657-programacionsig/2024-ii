
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pandas: paquete para manipulación y análisis de datos &#8212; GF-0657 Programación en SIG 2024-II</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contenido/3/pandas';</script>
    <link rel="canonical" href="https://gf0657-programacionsig.github.io/2024-ii/contenido/3/pandas.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="matplotlib: biblioteca para visualización de datos" href="matplotlib.html" />
    <link rel="prev" title="Interfaces de programación de aplicaciones (API)" href="../2/api.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="GF-0657 Programación en SIG 2024-II - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="GF-0657 Programación en SIG 2024-II - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">1 - INTRODUCCIÓN A LA PROGRAMACIÓN DE COMPUTADORAS Y A LA CIENCIA DE DATOS GEOESPACIALES</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1/introduccion-programacion-computadoras.html">Introducción a la programación de computadoras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1/introduccion-ciencia-datos.html">Introducción a la ciencia de datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1/introduccion-ciencia-datos-geoespaciales.html">Introducción a la ciencia de datos geoespaciales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1/markdown.html">Markdown - lenguaje de marcado</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">2 - EL LENGUAJE DE PROGRAMACIÓN PYTHON</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../2/introduccion-python.html">Introducción a Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2/lenguaje-python.html">El lenguaje Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2/api.html">Interfaces de programación de aplicaciones (API)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">3 - ANÁLISIS Y VISUALIZACIÓN DE DATOS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">pandas: paquete para manipulación y análisis de datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="matplotlib.html">matplotlib: biblioteca para visualización de datos</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">EVALUACIONES</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../evaluaciones/tarea-01.html">Tarea 1</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SOFTWARE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../software/vscode.html">Visual Studio Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/miniconda.html">Miniconda</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/gf0657-programacionsig/2024-ii/main?urlpath=tree/contenido/3/pandas.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/gf0657-programacionsig/2024-ii/blob/main/contenido/3/pandas.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/gf0657-programacionsig/2024-ii" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gf0657-programacionsig/2024-ii/edit/main/contenido/3/pandas.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gf0657-programacionsig/2024-ii/issues/new?title=Issue%20on%20page%20%2Fcontenido/3/pandas.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/contenido/3/pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>pandas: paquete para manipulación y análisis de datos</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">Introducción</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga">Carga</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuracion">Configuración</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estructuras-de-datos">Estructuras de datos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#series">Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframes">Dataframes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operaciones-basicas">Operaciones básicas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-datos">Carga de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#obtencion-de-informacion-general">Obtención de información general</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones-basicas-de-recuperacion-y-despliegue-de-datos">Funciones básicas de recuperación y despliegue de datos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#head-primeras-filas"><code class="docutils literal notranslate"><span class="pre">head()</span></code> - primeras filas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tail-ultimas-filas"><code class="docutils literal notranslate"><span class="pre">tail()</span></code> - últimas filas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-muestra-aleatoria-de-filas"><code class="docutils literal notranslate"><span class="pre">sample()</span></code> - muestra aleatoria de filas</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creacion-de-subconjuntos">Creación de subconjuntos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mediante-indices-numericos">Mediante índices numéricos</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mediante-etiquetas">Mediante etiquetas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mediante-expresiones-logicas">Mediante expresiones lógicas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-head-tail-y-sample">Métodos <code class="docutils literal notranslate"><span class="pre">head()</span></code>, <code class="docutils literal notranslate"><span class="pre">tail()</span></code> y <code class="docutils literal notranslate"><span class="pre">sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ordenamiento">Ordenamiento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creacion-y-modificacion-de-columnas">Creación y modificación de columnas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-pib-per-capita">Ejemplo: PIB per cápita</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-idiomas-oficiales">Ejemplo: idiomas oficiales</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupacion-y-agregacion">Agrupación y agregación</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#union-join">Unión (<em>join</em>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exportacion">Exportación</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recursos-de-interes">Recursos de interés</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pandas-paquete-para-manipulacion-y-analisis-de-datos">
<h1>pandas: paquete para manipulación y análisis de datos<a class="headerlink" href="#pandas-paquete-para-manipulacion-y-analisis-de-datos" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/gf0657-programacionsig/2024-ii/blob/main/contenido/3/pandas.ipynb"><img alt="Abrir en Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section id="introduccion">
<h2>Introducción<a class="headerlink" href="#introduccion" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://pandas.pydata.org/">pandas</a> es una biblioteca de Python para manipulación y análisis de datos. Fue creada por Wes McKinney en 2008. El nombre “pandas” puede considerarse un acrónimo de <em>Panel Data</em> o de <em>Python Data Analysis</em>.</p>
<p>Como su estructura principal, pandas implementa el <code class="docutils literal notranslate"><span class="pre">dataframe</span></code>, el cual es un arreglo rectangular de datos, organizado en filas y columnas. pandas proporciona también una gran cantidad de funciones para limpiar, procesar, analizar y visualizar datos en dataframes.</p>
</section>
<section id="carga">
<h2>Carga<a class="headerlink" href="#carga" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Carga de pandas con el alias pd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="configuracion">
<h2>Configuración<a class="headerlink" href="#configuracion" title="Link to this heading">#</a></h2>
<p>El método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.set_option.html">pandas.set_option()</a> se utiliza para configurar diversas opciones que controlan el comportamiento de pandas y la visualización de datos. Estas opciones permiten personalizar aspectos como:</p>
<ul class="simple">
<li><p>El número de filas y columnas que se muestran al desplegar conjuntos de datos.</p></li>
<li><p>La precisión al mostrar números decimales.</p></li>
<li><p>El ancho máximo de filas y columnas.</p></li>
<li><p>El formato de la fecha y la hora.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configuración de pandas para mostrar separadores de miles y 2 dígitos decimales</span>
<span class="c1"># Esto también evita la notación científica</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Otras funciones relacionadas con la configuración de pandas:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.describe_option.html">pandas.describe_option()</a>: muestra información sobre una opción (ej. <code class="docutils literal notranslate"><span class="pre">pd.describe_option('display.max_rows')</span></code>). <code class="docutils literal notranslate"><span class="pre">pd.describe_option()</span></code> describe todas las opciones.</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.get_option.html">pandas.get_option()</a>: muestra el valor actual de una opción de configuración (ej. <code class="docutils literal notranslate"><span class="pre">pd.get_option('display.max_rows')</span></code>).</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.reset_option.html">pandas.reset_option()</a>: reestablece el valor por defecto de una opción de configuración (ej. <code class="docutils literal notranslate"><span class="pre">pd.reset_option('display.max_rows')</span></code>). <code class="docutils literal notranslate"><span class="pre">pd.reset_option('all')</span></code> reestablece todas las opciones.</p></li>
</ul>
<p>Debe tenerse en cuenta que el uso de estas funciones aplica para toda una sesión de pandas y no, por ejemplo, para conjuntos de datos específicos.</p>
</section>
<section id="estructuras-de-datos">
<h2>Estructuras de datos<a class="headerlink" href="#estructuras-de-datos" title="Link to this heading">#</a></h2>
<p>Las dos principales estructuras de datos de pandas son las <code class="docutils literal notranslate"><span class="pre">series</span></code> y los <code class="docutils literal notranslate"><span class="pre">dataframes</span></code>.</p>
<section id="series">
<h3>Series<a class="headerlink" href="#series" title="Link to this heading">#</a></h3>
<p>Las <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html?highlight=series#pandas.Series"><code class="docutils literal notranslate"><span class="pre">series</span></code></a> son arreglos unidimensionales que contienen datos de cualquier tipo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definición de una serie a partir de una lista</span>

<span class="n">lista_primos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="n">serie_primos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lista_primos</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">serie_primos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     2
1     3
2     5
3     7
4    11
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Al igual que otras estructuras de datos de Python (ej. tuplas, listas), cada elemento de una serie tiene un índice (i.e. una posición). El índice del primer elemento es 0, el del segundo elemento es 1 y así sucesivamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Primer elemento</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Primer elemento:&quot;</span><span class="p">,</span> <span class="n">serie_primos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Segundo elemento</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Segundo elemento:&quot;</span><span class="p">,</span> <span class="n">serie_primos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Primer elemento: 2
Segundo elemento: 3
</pre></div>
</div>
</div>
</div>
<p>A diferencia de las tuplas y las listas, las series pueden tener índices no numéricos, a los cuales se les llama etiquetas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Índices de una serie con etiquetas personalizadas</span>
<span class="n">serie_primos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lista_primos</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">])</span>

<span class="n">serie_primos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A     2
B     3
C     5
D     7
E    11
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Elemento en la posición B</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elemento en B:&quot;</span><span class="p">,</span> <span class="n">serie_primos</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">])</span>

<span class="c1"># Elemento en la posición D</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elemento en D:&quot;</span><span class="p">,</span> <span class="n">serie_primos</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elemento en B: 3
Elemento en D: 7
</pre></div>
</div>
</div>
</div>
<p><strong>Ejercicios</strong></p>
<ol class="arabic simple">
<li><p>Cree una serie que contenga los montos de ventas de una tienda para los 12 meses del año. Utilice los nombres de los meses como índices.</p></li>
</ol>
</section>
<section id="dataframes">
<h3>Dataframes<a class="headerlink" href="#dataframes" title="Link to this heading">#</a></h3>
<p>Los <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame"><code class="docutils literal notranslate"><span class="pre">dataframes</span></code></a> son estructuras de datos multidimensionales compuestas por filas y columnas. Un dataframe puede verse como una tabla cuyas columnas se implementan como series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dataframe generado a partir de un diccionario</span>

<span class="n">diccionario_paises</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;pais&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PA&quot;</span><span class="p">,</span> <span class="s2">&quot;CR&quot;</span><span class="p">,</span> <span class="s2">&quot;NI&quot;</span><span class="p">],</span>
  <span class="s2">&quot;poblacion&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4246439</span><span class="p">,</span> <span class="mi">5047561</span><span class="p">,</span> <span class="mi">6545502</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">df_paises</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">diccionario_paises</span><span class="p">)</span>

<span class="n">df_paises</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pais</th>
      <th>poblacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PA</td>
      <td>4246439</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CR</td>
      <td>5047561</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NI</td>
      <td>6545502</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La propiedad <strong>iloc</strong> retorna una o más filas de un dataframe, de acuerdo con un índice o una lista de índices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Segunda fila</span>
<span class="n">df_paises</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pais              CR
poblacion    5047561
Name: 1, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Segunda y tercera fila</span>
<span class="n">df_paises</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pais</th>
      <th>poblacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>CR</td>
      <td>5047561</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NI</td>
      <td>6545502</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Los índices de los dataframes también pueden etiquetarse.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dataframe con índices etiquetados</span>

<span class="n">df_paises</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">diccionario_paises</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pais_0&quot;</span><span class="p">,</span> <span class="s2">&quot;pais_1&quot;</span><span class="p">,</span> <span class="s2">&quot;pais_2&quot;</span><span class="p">])</span>

<span class="n">df_paises</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pais</th>
      <th>poblacion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pais_0</th>
      <td>PA</td>
      <td>4246439</td>
    </tr>
    <tr>
      <th>pais_1</th>
      <td>CR</td>
      <td>5047561</td>
    </tr>
    <tr>
      <th>pais_2</th>
      <td>NI</td>
      <td>6545502</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La propiedad <strong>loc</strong> retorna una o más filas de un dataframe, de acuerdo con sus etiquetas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fila en &quot;pais_0&quot;</span>
<span class="n">df_paises</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;pais_0&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pais              PA
poblacion    4246439
Name: pais_0, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="operaciones-basicas">
<h2>Operaciones básicas<a class="headerlink" href="#operaciones-basicas" title="Link to this heading">#</a></h2>
<p>Seguidamente, se describen y ejemplifican algunas de las funciones básicas que pueden realizarse en un dataframe de pandas.</p>
<p>En los siguientes ejemplos, se utilizará un conjunto de datos de países descargado de <a class="reference external" href="https://www.naturalearthdata.com/">Natural Earth</a>.</p>
<section id="carga-de-datos">
<h3>Carga de datos<a class="headerlink" href="#carga-de-datos" title="Link to this heading">#</a></h3>
<p>El método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html#pandas.read_csv"><code class="docutils literal notranslate"><span class="pre">pandas.read_csv()</span></code></a> carga un archivo de valores separados por comas (CSV) en un dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Carga de un archivo CSV remoto en un dataframe</span>

<span class="n">paises</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/gf0657-programacionsig/2024-ii/refs/heads/main/datos/natural-earth/paises.csv&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Ejercicios</strong></p>
<ol class="arabic simple">
<li><p>Descargue en su computadora el archivo <code class="docutils literal notranslate"><span class="pre">paises.csv</span></code> y cárguelo en otro dataframe.</p></li>
</ol>
</section>
<section id="obtencion-de-informacion-general">
<h3>Obtención de información general<a class="headerlink" href="#obtencion-de-informacion-general" title="Link to this heading">#</a></h3>
<p>El método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.info.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.info()</span></code></a> despliega un resumen de información sobre un dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Información general sobre un dataframe</span>

<span class="n">paises</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 201 entries, 0 to 200
Data columns (total 10 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   ADM0_ISO    201 non-null    object 
 1   NAME        201 non-null    object 
 2   CONTINENT   201 non-null    object 
 3   REGION_UN   201 non-null    object 
 4   SUBREGION   201 non-null    object 
 5   REGION_WB   201 non-null    object 
 6   ECONOMY     201 non-null    object 
 7   INCOME_GRP  201 non-null    object 
 8   POP_EST     201 non-null    float64
 9   GDP_MD      201 non-null    int64  
dtypes: float64(1), int64(1), object(8)
memory usage: 15.8+ KB
</pre></div>
</div>
</div>
</div>
</section>
<section id="funciones-basicas-de-recuperacion-y-despliegue-de-datos">
<h3>Funciones básicas de recuperación y despliegue de datos<a class="headerlink" href="#funciones-basicas-de-recuperacion-y-despliegue-de-datos" title="Link to this heading">#</a></h3>
<p>Los datos contenidos en un dataframe pueden visualizarse con la función <code class="docutils literal notranslate"><span class="pre">print()</span></code>. En un cuaderno de notas, basta también con ejecutar una celda con el nombre del dataframe. Esta última opción genera una salida más legible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Despliegue de los datos de un dataframe</span>

<span class="n">paises</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADM0_ISO</th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>IDN</td>
      <td>Indonesia</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>South-Eastern Asia</td>
      <td>East Asia &amp; Pacific</td>
      <td>4. Emerging region: MIKT</td>
      <td>4. Lower middle income</td>
      <td>270,625,568.00</td>
      <td>1119190</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MYS</td>
      <td>Malaysia</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>South-Eastern Asia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>3. Upper middle income</td>
      <td>31,949,777.00</td>
      <td>364681</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHL</td>
      <td>Chile</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>18,952,038.00</td>
      <td>282318</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BOL</td>
      <td>Bolivia</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>4. Lower middle income</td>
      <td>11,513,100.00</td>
      <td>40895</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PER</td>
      <td>Peru</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>32,510,453.00</td>
      <td>226848</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>196</th>
      <td>NRU</td>
      <td>Nauru</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Micronesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>12,581.00</td>
      <td>118</td>
    </tr>
    <tr>
      <th>197</th>
      <td>FSM</td>
      <td>Micronesia</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Micronesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>113,815.00</td>
      <td>401</td>
    </tr>
    <tr>
      <th>198</th>
      <td>VUT</td>
      <td>Vanuatu</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Melanesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>7. Least developed region</td>
      <td>4. Lower middle income</td>
      <td>299,882.00</td>
      <td>934</td>
    </tr>
    <tr>
      <th>199</th>
      <td>PLW</td>
      <td>Palau</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Micronesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>3. Upper middle income</td>
      <td>18,008.00</td>
      <td>268</td>
    </tr>
    <tr>
      <th>200</th>
      <td>BHR</td>
      <td>Bahrain</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Western Asia</td>
      <td>Middle East &amp; North Africa</td>
      <td>6. Developing region</td>
      <td>2. High income: nonOECD</td>
      <td>1,641,172.00</td>
      <td>38574</td>
    </tr>
  </tbody>
</table>
<p>201 rows × 10 columns</p>
</div></div></div>
</div>
<p>Es posible que la cantidad de filas sea muy grande para desplegarse completamente en la pantalla, por lo que es usual emplear algunos métodos para limitarla.</p>
<section id="head-primeras-filas">
<h4><code class="docutils literal notranslate"><span class="pre">head()</span></code> - primeras filas<a class="headerlink" href="#head-primeras-filas" title="Link to this heading">#</a></h4>
<p>El método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.head.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.head()</span></code></a> retorna las primeras n filas de un dataframe (por defecto, n=5).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Primeras 5 filas de un dataframe</span>

<span class="n">paises</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADM0_ISO</th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>IDN</td>
      <td>Indonesia</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>South-Eastern Asia</td>
      <td>East Asia &amp; Pacific</td>
      <td>4. Emerging region: MIKT</td>
      <td>4. Lower middle income</td>
      <td>270,625,568.00</td>
      <td>1119190</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MYS</td>
      <td>Malaysia</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>South-Eastern Asia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>3. Upper middle income</td>
      <td>31,949,777.00</td>
      <td>364681</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHL</td>
      <td>Chile</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>18,952,038.00</td>
      <td>282318</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BOL</td>
      <td>Bolivia</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>4. Lower middle income</td>
      <td>11,513,100.00</td>
      <td>40895</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PER</td>
      <td>Peru</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>32,510,453.00</td>
      <td>226848</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="tail-ultimas-filas">
<h4><code class="docutils literal notranslate"><span class="pre">tail()</span></code> - últimas filas<a class="headerlink" href="#tail-ultimas-filas" title="Link to this heading">#</a></h4>
<p>El método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.tail.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.tail()</span></code></a> retorna las últimas n filas de un dataframe (por defecto, n=5).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Últimas 10 filas de un dataframe</span>

<span class="n">paises</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADM0_ISO</th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>191</th>
      <td>TON</td>
      <td>Tonga</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Polynesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>104,494.00</td>
      <td>512</td>
    </tr>
    <tr>
      <th>192</th>
      <td>WSM</td>
      <td>Samoa</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Polynesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>7. Least developed region</td>
      <td>4. Lower middle income</td>
      <td>197,097.00</td>
      <td>852</td>
    </tr>
    <tr>
      <th>193</th>
      <td>SLB</td>
      <td>Solomon Is.</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Melanesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>7. Least developed region</td>
      <td>4. Lower middle income</td>
      <td>669,823.00</td>
      <td>1589</td>
    </tr>
    <tr>
      <th>194</th>
      <td>TUV</td>
      <td>Tuvalu</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Polynesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>7. Least developed region</td>
      <td>3. Upper middle income</td>
      <td>11,646.00</td>
      <td>47</td>
    </tr>
    <tr>
      <th>195</th>
      <td>MDV</td>
      <td>Maldives</td>
      <td>Seven seas (open ocean)</td>
      <td>Asia</td>
      <td>Southern Asia</td>
      <td>South Asia</td>
      <td>6. Developing region</td>
      <td>3. Upper middle income</td>
      <td>530,953.00</td>
      <td>5642</td>
    </tr>
    <tr>
      <th>196</th>
      <td>NRU</td>
      <td>Nauru</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Micronesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>12,581.00</td>
      <td>118</td>
    </tr>
    <tr>
      <th>197</th>
      <td>FSM</td>
      <td>Micronesia</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Micronesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>113,815.00</td>
      <td>401</td>
    </tr>
    <tr>
      <th>198</th>
      <td>VUT</td>
      <td>Vanuatu</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Melanesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>7. Least developed region</td>
      <td>4. Lower middle income</td>
      <td>299,882.00</td>
      <td>934</td>
    </tr>
    <tr>
      <th>199</th>
      <td>PLW</td>
      <td>Palau</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Micronesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>3. Upper middle income</td>
      <td>18,008.00</td>
      <td>268</td>
    </tr>
    <tr>
      <th>200</th>
      <td>BHR</td>
      <td>Bahrain</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Western Asia</td>
      <td>Middle East &amp; North Africa</td>
      <td>6. Developing region</td>
      <td>2. High income: nonOECD</td>
      <td>1,641,172.00</td>
      <td>38574</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="sample-muestra-aleatoria-de-filas">
<h4><code class="docutils literal notranslate"><span class="pre">sample()</span></code> - muestra aleatoria de filas<a class="headerlink" href="#sample-muestra-aleatoria-de-filas" title="Link to this heading">#</a></h4>
<p>El método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sample.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.sample()</span></code></a> retorna una muestra aleatoria de n filas de un dataframe (por defecto, n=1).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Muestra aleatoria de 3 filas de un dataframe</span>

<span class="n">paises</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADM0_ISO</th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>CHL</td>
      <td>Chile</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>18,952,038.00</td>
      <td>282318</td>
    </tr>
    <tr>
      <th>14</th>
      <td>SOM</td>
      <td>Somalia</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Eastern Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7. Least developed region</td>
      <td>5. Low income</td>
      <td>10,192,317.30</td>
      <td>4719</td>
    </tr>
    <tr>
      <th>44</th>
      <td>MNG</td>
      <td>Mongolia</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Eastern Asia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>3,225,167.00</td>
      <td>13996</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="creacion-de-subconjuntos">
<h3>Creación de subconjuntos<a class="headerlink" href="#creacion-de-subconjuntos" title="Link to this heading">#</a></h3>
<p>Una de las operaciones más comunes de manipulación y análisis de datos es la creación de subconjuntos. En el caso de un dataframe, estos subconjuntos pueden ser de filas, de columnas o de ambas a la vez. Pueden crearse de varias formas.</p>
<section id="mediante-indices-numericos">
<h4>Mediante índices numéricos<a class="headerlink" href="#mediante-indices-numericos" title="Link to this heading">#</a></h4>
<p>La propiedad <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.iloc.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.iloc</span></code></a> permite seleccionar filas y columnas de un dataframe por sus índices numéricos.</p>
<p>Índice de una fila:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fila 0</span>
<span class="n">paises</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADM0_ISO                           IDN
NAME                         Indonesia
CONTINENT                         Asia
REGION_UN                         Asia
SUBREGION           South-Eastern Asia
REGION_WB          East Asia &amp; Pacific
ECONOMY       4. Emerging region: MIKT
INCOME_GRP      4. Lower middle income
POP_EST                 270,625,568.00
GDP_MD                         1119190
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Rango de filas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filas entre la 5 (inclusive) y la 7 (inclusive)</span>
<span class="n">paises</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADM0_ISO</th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>ARG</td>
      <td>Argentina</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>44,938,712.00</td>
      <td>445445</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GBR</td>
      <td>United Kingdom</td>
      <td>Europe</td>
      <td>Europe</td>
      <td>Northern Europe</td>
      <td>Europe &amp; Central Asia</td>
      <td>1. Developed region: G7</td>
      <td>1. High income: OECD</td>
      <td>67,366,465.00</td>
      <td>2863166</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CYP</td>
      <td>Cyprus</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Western Asia</td>
      <td>Europe &amp; Central Asia</td>
      <td>6. Developing region</td>
      <td>2. High income: nonOECD</td>
      <td>1,198,575.00</td>
      <td>24948</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Lista de índices de filas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filas 3, 5 y 7</span>
<span class="n">paises</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADM0_ISO</th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>BOL</td>
      <td>Bolivia</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>4. Lower middle income</td>
      <td>11,513,100.00</td>
      <td>40895</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ARG</td>
      <td>Argentina</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>44,938,712.00</td>
      <td>445445</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CYP</td>
      <td>Cyprus</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Western Asia</td>
      <td>Europe &amp; Central Asia</td>
      <td>6. Developing region</td>
      <td>2. High income: nonOECD</td>
      <td>1,198,575.00</td>
      <td>24948</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="mediante-etiquetas">
<h4>Mediante etiquetas<a class="headerlink" href="#mediante-etiquetas" title="Link to this heading">#</a></h4>
<p>La propiedad <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.loc</span></code></a> permite seleccionar filas y columnas de un dataframe por sus etiquetas.</p>
<p>El método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.set_index.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.set_index()</span></code></a> crea índices (etiquetas en las filas) para un dataframe con base en columnas existentes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Se usa la columna ADM0_ISO como índice</span>
<span class="n">paises</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ADM0_ISO&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">paises</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IDN</th>
      <td>Indonesia</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>South-Eastern Asia</td>
      <td>East Asia &amp; Pacific</td>
      <td>4. Emerging region: MIKT</td>
      <td>4. Lower middle income</td>
      <td>270,625,568.00</td>
      <td>1119190</td>
    </tr>
    <tr>
      <th>MYS</th>
      <td>Malaysia</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>South-Eastern Asia</td>
      <td>East Asia &amp; Pacific</td>
      <td>6. Developing region</td>
      <td>3. Upper middle income</td>
      <td>31,949,777.00</td>
      <td>364681</td>
    </tr>
    <tr>
      <th>CHL</th>
      <td>Chile</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>18,952,038.00</td>
      <td>282318</td>
    </tr>
    <tr>
      <th>BOL</th>
      <td>Bolivia</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>4. Lower middle income</td>
      <td>11,513,100.00</td>
      <td>40895</td>
    </tr>
    <tr>
      <th>PER</th>
      <td>Peru</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>32,510,453.00</td>
      <td>226848</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si se desea reestablecer el índice al numérico predeterminado, puede utilizarse el método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.reset_index.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.reset_index()</span></code></a>.</p>
<p>Una vez que se han creado las etiquetas, puede usarse <code class="docutils literal notranslate"><span class="pre">loc</span></code> para seleccionarlas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fila correspondiente a Costa Rica</span>
<span class="n">paises</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;CRI&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NAME                         Costa Rica
CONTINENT                 North America
REGION_UN                      Americas
SUBREGION               Central America
REGION_WB     Latin America &amp; Caribbean
ECONOMY         5. Emerging region: G20
INCOME_GRP       3. Upper middle income
POP_EST                    5,047,561.00
GDP_MD                            61801
Name: CRI, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lista de filas correspondientes a Costa Rica, Nicaragua y Panamá</span>
<span class="n">paises</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;CRI&#39;</span><span class="p">,</span> <span class="s1">&#39;NIC&#39;</span><span class="p">,</span> <span class="s1">&#39;PAN&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CRI</th>
      <td>Costa Rica</td>
      <td>North America</td>
      <td>Americas</td>
      <td>Central America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>5,047,561.00</td>
      <td>61801</td>
    </tr>
    <tr>
      <th>NIC</th>
      <td>Nicaragua</td>
      <td>North America</td>
      <td>Americas</td>
      <td>Central America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>6,545,502.00</td>
      <td>12520</td>
    </tr>
    <tr>
      <th>PAN</th>
      <td>Panama</td>
      <td>North America</td>
      <td>Americas</td>
      <td>Central America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>6. Developing region</td>
      <td>3. Upper middle income</td>
      <td>4,246,439.00</td>
      <td>66800</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lista de etiquetas de filas y lista de etiquetas de columnas</span>
<span class="n">paises</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;CRI&#39;</span><span class="p">,</span> <span class="s1">&#39;NIC&#39;</span><span class="p">,</span> <span class="s1">&#39;PAN&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;POP_EST&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>POP_EST</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CRI</th>
      <td>Costa Rica</td>
      <td>5,047,561.00</td>
    </tr>
    <tr>
      <th>NIC</th>
      <td>Nicaragua</td>
      <td>6,545,502.00</td>
    </tr>
    <tr>
      <th>PAN</th>
      <td>Panama</td>
      <td>4,246,439.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nombres y poblaciones de países de América Central</span>
<span class="n">poblaciones_america_central</span> <span class="o">=</span> <span class="n">paises</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;PAN&#39;</span><span class="p">,</span> <span class="s1">&#39;CRI&#39;</span><span class="p">,</span> <span class="s1">&#39;NIC&#39;</span><span class="p">,</span> <span class="s1">&#39;HND&#39;</span><span class="p">,</span> <span class="s1">&#39;SLV&#39;</span><span class="p">,</span> <span class="s1">&#39;GTM&#39;</span><span class="p">,</span> <span class="s1">&#39;BLZ&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;POP_EST&#39;</span><span class="p">]]</span>

<span class="n">poblaciones_america_central</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>POP_EST</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PAN</th>
      <td>Panama</td>
      <td>4,246,439.00</td>
    </tr>
    <tr>
      <th>CRI</th>
      <td>Costa Rica</td>
      <td>5,047,561.00</td>
    </tr>
    <tr>
      <th>NIC</th>
      <td>Nicaragua</td>
      <td>6,545,502.00</td>
    </tr>
    <tr>
      <th>HND</th>
      <td>Honduras</td>
      <td>9,746,117.00</td>
    </tr>
    <tr>
      <th>SLV</th>
      <td>El Salvador</td>
      <td>6,453,553.00</td>
    </tr>
    <tr>
      <th>GTM</th>
      <td>Guatemala</td>
      <td>16,604,026.00</td>
    </tr>
    <tr>
      <th>BLZ</th>
      <td>Belize</td>
      <td>390,353.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Ejercicios</strong></p>
<ol class="arabic simple">
<li><p>Seleccione los países de la península ibérica y las columnas correspondientes a sus nombres y a su producto interno bruto.</p></li>
</ol>
</section>
<section id="mediante-expresiones-logicas">
<h4>Mediante expresiones lógicas<a class="headerlink" href="#mediante-expresiones-logicas" title="Link to this heading">#</a></h4>
<p>Un dataframe puede filtrarse mediante expresiones lógicas, las cuales pueden incluir los operadores:</p>
<p>Y lógico (<em>AND</em>): <code class="docutils literal notranslate"><span class="pre">&amp;</span></code><br />
O lógico (<em>OR</em>): <code class="docutils literal notranslate"><span class="pre">|</span></code><br />
No lógico (<em>NOT</em>): <code class="docutils literal notranslate"><span class="pre">~</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Países con más de 200 millones de habitantes</span>
<span class="n">paises_muy_poblados</span> <span class="o">=</span> <span class="n">paises</span><span class="p">[</span><span class="n">paises</span><span class="p">[</span><span class="s1">&#39;POP_EST&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">200000000</span><span class="p">]</span>

<span class="n">paises_muy_poblados</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IDN</th>
      <td>Indonesia</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>South-Eastern Asia</td>
      <td>East Asia &amp; Pacific</td>
      <td>4. Emerging region: MIKT</td>
      <td>4. Lower middle income</td>
      <td>270,625,568.00</td>
      <td>1119190</td>
    </tr>
    <tr>
      <th>IND</th>
      <td>India</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Southern Asia</td>
      <td>South Asia</td>
      <td>3. Emerging region: BRIC</td>
      <td>4. Lower middle income</td>
      <td>1,366,417,754.00</td>
      <td>2868929</td>
    </tr>
    <tr>
      <th>CHN</th>
      <td>China</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Eastern Asia</td>
      <td>East Asia &amp; Pacific</td>
      <td>3. Emerging region: BRIC</td>
      <td>3. Upper middle income</td>
      <td>1,405,862,845.00</td>
      <td>14762473</td>
    </tr>
    <tr>
      <th>BRA</th>
      <td>Brazil</td>
      <td>South America</td>
      <td>Americas</td>
      <td>South America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>3. Emerging region: BRIC</td>
      <td>3. Upper middle income</td>
      <td>211,049,527.00</td>
      <td>1839758</td>
    </tr>
    <tr>
      <th>NGA</th>
      <td>Nigeria</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Western Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>5. Emerging region: G20</td>
      <td>4. Lower middle income</td>
      <td>200,963,599.00</td>
      <td>448120</td>
    </tr>
    <tr>
      <th>PAK</th>
      <td>Pakistan</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Southern Asia</td>
      <td>South Asia</td>
      <td>5. Emerging region: G20</td>
      <td>4. Lower middle income</td>
      <td>216,565,318.00</td>
      <td>278221</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>United States of America</td>
      <td>North America</td>
      <td>Americas</td>
      <td>Northern America</td>
      <td>North America</td>
      <td>1. Developed region: G7</td>
      <td>1. High income: OECD</td>
      <td>331,595,460.00</td>
      <td>21542705</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Países con más de 200 millones de habitantes, incluyendo solo NAME, CONTINENT y POP_EST</span>
<span class="n">paises_muy_poblados</span> <span class="o">=</span> <span class="n">paises</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">paises</span><span class="p">[</span><span class="s1">&#39;POP_EST&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">200000000</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;CONTINENT&#39;</span><span class="p">,</span> <span class="s1">&#39;POP_EST&#39;</span><span class="p">]]</span>

<span class="n">paises_muy_poblados</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>POP_EST</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IDN</th>
      <td>Indonesia</td>
      <td>Asia</td>
      <td>270,625,568.00</td>
    </tr>
    <tr>
      <th>IND</th>
      <td>India</td>
      <td>Asia</td>
      <td>1,366,417,754.00</td>
    </tr>
    <tr>
      <th>CHN</th>
      <td>China</td>
      <td>Asia</td>
      <td>1,405,862,845.00</td>
    </tr>
    <tr>
      <th>BRA</th>
      <td>Brazil</td>
      <td>South America</td>
      <td>211,049,527.00</td>
    </tr>
    <tr>
      <th>NGA</th>
      <td>Nigeria</td>
      <td>Africa</td>
      <td>200,963,599.00</td>
    </tr>
    <tr>
      <th>PAK</th>
      <td>Pakistan</td>
      <td>Asia</td>
      <td>216,565,318.00</td>
    </tr>
    <tr>
      <th>USA</th>
      <td>United States of America</td>
      <td>North America</td>
      <td>331,595,460.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Países asiáticos con más de 200 millones de habitantes, incluyendo solo NAME, CONTINENT y POP_EST</span>
<span class="n">paises_asiaticos_muy_poblados</span> <span class="o">=</span> <span class="n">paises</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span><span class="n">paises</span><span class="p">[</span><span class="s1">&#39;POP_EST&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">200000000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">paises</span><span class="p">[</span><span class="s1">&#39;CONTINENT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Asia&#39;</span><span class="p">),</span> 
    <span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;CONTINENT&#39;</span><span class="p">,</span> <span class="s1">&#39;POP_EST&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">paises_asiaticos_muy_poblados</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>POP_EST</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IDN</th>
      <td>Indonesia</td>
      <td>Asia</td>
      <td>270,625,568.00</td>
    </tr>
    <tr>
      <th>IND</th>
      <td>India</td>
      <td>Asia</td>
      <td>1,366,417,754.00</td>
    </tr>
    <tr>
      <th>CHN</th>
      <td>China</td>
      <td>Asia</td>
      <td>1,405,862,845.00</td>
    </tr>
    <tr>
      <th>PAK</th>
      <td>Pakistan</td>
      <td>Asia</td>
      <td>216,565,318.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Países asiáticos o africanos con más de 200 millones de habitantes, incluyendo solo NAME, CONTINENT y POP_EST</span>
<span class="n">paises_asiaticos_africanos_muy_poblados</span> <span class="o">=</span> <span class="n">paises</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">(</span><span class="n">paises</span><span class="p">[</span><span class="s1">&#39;POP_EST&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">200000000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">paises</span><span class="p">[</span><span class="s1">&#39;CONTINENT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Asia&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">paises</span><span class="p">[</span><span class="s1">&#39;CONTINENT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Africa&#39;</span><span class="p">)),</span> 
    <span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;CONTINENT&#39;</span><span class="p">,</span> <span class="s1">&#39;POP_EST&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">paises_asiaticos_africanos_muy_poblados</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>POP_EST</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IDN</th>
      <td>Indonesia</td>
      <td>Asia</td>
      <td>270,625,568.00</td>
    </tr>
    <tr>
      <th>IND</th>
      <td>India</td>
      <td>Asia</td>
      <td>1,366,417,754.00</td>
    </tr>
    <tr>
      <th>CHN</th>
      <td>China</td>
      <td>Asia</td>
      <td>1,405,862,845.00</td>
    </tr>
    <tr>
      <th>NGA</th>
      <td>Nigeria</td>
      <td>Africa</td>
      <td>200,963,599.00</td>
    </tr>
    <tr>
      <th>PAK</th>
      <td>Pakistan</td>
      <td>Asia</td>
      <td>216,565,318.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="metodos-head-tail-y-sample">
<h4>Métodos <code class="docutils literal notranslate"><span class="pre">head()</span></code>, <code class="docutils literal notranslate"><span class="pre">tail()</span></code> y <code class="docutils literal notranslate"><span class="pre">sample()</span></code><a class="headerlink" href="#metodos-head-tail-y-sample" title="Link to this heading">#</a></h4>
<p>Los métodos <code class="docutils literal notranslate"><span class="pre">head()</span></code>, <code class="docutils literal notranslate"><span class="pre">tail()</span></code> y <code class="docutils literal notranslate"><span class="pre">sample()</span></code>, descritos anteriormente, también pueden emplearse para crear subconjuntos.</p>
<p><strong>Ejercicios</strong></p>
<ol class="arabic simple">
<li><p>Cree un subconjunto de los países con producto interno bruto (<code class="docutils literal notranslate"><span class="pre">GDP_MD</span></code>) menor a 1000 millones de dólares.</p></li>
<li><p>Cree un subconjunto de los países con producto interno bruto menor a 1000 millones de dólares y con más de un millón de habitantes.</p></li>
<li><p>Cree un subconjunto de los países de América Central, excepto Belice.</p></li>
<li><p>Cree un subconjunto de los siete países de América Central y, además, República Dominicana.</p></li>
</ol>
</section>
</section>
<section id="ordenamiento">
<h3>Ordenamiento<a class="headerlink" href="#ordenamiento" title="Link to this heading">#</a></h3>
<p>El método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.sort_values()</span></code></a> ordena un dataframe de pandas por una o por varias columnas, en orden ascendente o descendente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ordenamiento ascendente de países por nombre</span>
<span class="n">paises</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;NAME&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AFG</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Southern Asia</td>
      <td>South Asia</td>
      <td>7. Least developed region</td>
      <td>5. Low income</td>
      <td>38,041,754.00</td>
      <td>19291</td>
    </tr>
    <tr>
      <th>ALB</th>
      <td>Albania</td>
      <td>Europe</td>
      <td>Europe</td>
      <td>Southern Europe</td>
      <td>Europe &amp; Central Asia</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>2,854,191.00</td>
      <td>15279</td>
    </tr>
    <tr>
      <th>DZA</th>
      <td>Algeria</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Northern Africa</td>
      <td>Middle East &amp; North Africa</td>
      <td>6. Developing region</td>
      <td>3. Upper middle income</td>
      <td>43,053,054.00</td>
      <td>171091</td>
    </tr>
    <tr>
      <th>AND</th>
      <td>Andorra</td>
      <td>Europe</td>
      <td>Europe</td>
      <td>Southern Europe</td>
      <td>Europe &amp; Central Asia</td>
      <td>2. Developed region: nonG7</td>
      <td>2. High income: nonOECD</td>
      <td>77,142.00</td>
      <td>3154</td>
    </tr>
    <tr>
      <th>AGO</th>
      <td>Angola</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Middle Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7. Least developed region</td>
      <td>3. Upper middle income</td>
      <td>31,825,295.00</td>
      <td>88815</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>B28</th>
      <td>W. Sahara</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Northern Africa</td>
      <td>Middle East &amp; North Africa</td>
      <td>7. Least developed region</td>
      <td>5. Low income</td>
      <td>603,253.00</td>
      <td>907</td>
    </tr>
    <tr>
      <th>YEM</th>
      <td>Yemen</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Western Asia</td>
      <td>Middle East &amp; North Africa</td>
      <td>7. Least developed region</td>
      <td>4. Lower middle income</td>
      <td>29,161,922.00</td>
      <td>22581</td>
    </tr>
    <tr>
      <th>ZMB</th>
      <td>Zambia</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Eastern Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7. Least developed region</td>
      <td>4. Lower middle income</td>
      <td>17,861,030.00</td>
      <td>23309</td>
    </tr>
    <tr>
      <th>ZWE</th>
      <td>Zimbabwe</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Eastern Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>5. Emerging region: G20</td>
      <td>5. Low income</td>
      <td>14,645,468.00</td>
      <td>21440</td>
    </tr>
    <tr>
      <th>SWZ</th>
      <td>eSwatini</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Southern Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>1,148,130.00</td>
      <td>4471</td>
    </tr>
  </tbody>
</table>
<p>201 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ordenamiento ascendente de países por nombre y despliegue de las 5 primeras filas</span>
<span class="n">paises</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;NAME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AFG</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Southern Asia</td>
      <td>South Asia</td>
      <td>7. Least developed region</td>
      <td>5. Low income</td>
      <td>38,041,754.00</td>
      <td>19291</td>
    </tr>
    <tr>
      <th>ALB</th>
      <td>Albania</td>
      <td>Europe</td>
      <td>Europe</td>
      <td>Southern Europe</td>
      <td>Europe &amp; Central Asia</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>2,854,191.00</td>
      <td>15279</td>
    </tr>
    <tr>
      <th>DZA</th>
      <td>Algeria</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Northern Africa</td>
      <td>Middle East &amp; North Africa</td>
      <td>6. Developing region</td>
      <td>3. Upper middle income</td>
      <td>43,053,054.00</td>
      <td>171091</td>
    </tr>
    <tr>
      <th>AND</th>
      <td>Andorra</td>
      <td>Europe</td>
      <td>Europe</td>
      <td>Southern Europe</td>
      <td>Europe &amp; Central Asia</td>
      <td>2. Developed region: nonG7</td>
      <td>2. High income: nonOECD</td>
      <td>77,142.00</td>
      <td>3154</td>
    </tr>
    <tr>
      <th>AGO</th>
      <td>Angola</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Middle Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7. Least developed region</td>
      <td>3. Upper middle income</td>
      <td>31,825,295.00</td>
      <td>88815</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ordenamiento descendente de países por nombre y despliegue de las 5 primeras filas</span>
<span class="n">paises</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SWZ</th>
      <td>eSwatini</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Southern Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>6. Developing region</td>
      <td>4. Lower middle income</td>
      <td>1,148,130.00</td>
      <td>4471</td>
    </tr>
    <tr>
      <th>ZWE</th>
      <td>Zimbabwe</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Eastern Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>5. Emerging region: G20</td>
      <td>5. Low income</td>
      <td>14,645,468.00</td>
      <td>21440</td>
    </tr>
    <tr>
      <th>ZMB</th>
      <td>Zambia</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Eastern Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7. Least developed region</td>
      <td>4. Lower middle income</td>
      <td>17,861,030.00</td>
      <td>23309</td>
    </tr>
    <tr>
      <th>YEM</th>
      <td>Yemen</td>
      <td>Asia</td>
      <td>Asia</td>
      <td>Western Asia</td>
      <td>Middle East &amp; North Africa</td>
      <td>7. Least developed region</td>
      <td>4. Lower middle income</td>
      <td>29,161,922.00</td>
      <td>22581</td>
    </tr>
    <tr>
      <th>B28</th>
      <td>W. Sahara</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Northern Africa</td>
      <td>Middle East &amp; North Africa</td>
      <td>7. Least developed region</td>
      <td>5. Low income</td>
      <td>603,253.00</td>
      <td>907</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ordenamiento de países por continente y nombre</span>
<span class="n">paises</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CONTINENT&#39;</span><span class="p">,</span> <span class="s1">&#39;NAME&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])[[</span><span class="s1">&#39;CONTINENT&#39;</span><span class="p">,</span> <span class="s1">&#39;NAME&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CONTINENT</th>
      <th>NAME</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DZA</th>
      <td>Africa</td>
      <td>Algeria</td>
    </tr>
    <tr>
      <th>AGO</th>
      <td>Africa</td>
      <td>Angola</td>
    </tr>
    <tr>
      <th>BEN</th>
      <td>Africa</td>
      <td>Benin</td>
    </tr>
    <tr>
      <th>BWA</th>
      <td>Africa</td>
      <td>Botswana</td>
    </tr>
    <tr>
      <th>BFA</th>
      <td>Africa</td>
      <td>Burkina Faso</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>PRY</th>
      <td>South America</td>
      <td>Paraguay</td>
    </tr>
    <tr>
      <th>PER</th>
      <td>South America</td>
      <td>Peru</td>
    </tr>
    <tr>
      <th>SUR</th>
      <td>South America</td>
      <td>Suriname</td>
    </tr>
    <tr>
      <th>URY</th>
      <td>South America</td>
      <td>Uruguay</td>
    </tr>
    <tr>
      <th>VEN</th>
      <td>South America</td>
      <td>Venezuela</td>
    </tr>
  </tbody>
</table>
<p>201 rows × 2 columns</p>
</div></div></div>
</div>
<p><strong>Ejercicios</strong></p>
<ol class="arabic simple">
<li><p>Cree un subconjunto de todos los países del mundo ordenado descendentemente por la cantidad de habitantes.</p></li>
<li><p>Cree un subconjunto de todos los países del mundo ordenado ascendentemente por el producto interno bruto.</p></li>
</ol>
</section>
<section id="creacion-y-modificacion-de-columnas">
<h3>Creación y modificación de columnas<a class="headerlink" href="#creacion-y-modificacion-de-columnas" title="Link to this heading">#</a></h3>
<p>En un dataframe, pueden crearse o modificarse columnas de varias formas. Una de las más comunes es a través de operaciones con otras columnas.</p>
<section id="ejemplo-pib-per-capita">
<h4>Ejemplo: PIB per cápita<a class="headerlink" href="#ejemplo-pib-per-capita" title="Link to this heading">#</a></h4>
<p>En el dataframe <code class="docutils literal notranslate"><span class="pre">paises</span></code> puede crearse una nueva columna llamada <code class="docutils literal notranslate"><span class="pre">GDP_MD_PC</span></code> con el resultado del cálculo del <a class="reference external" href="https://es.wikipedia.org/wiki/Renta_per_c%C3%A1pita">Producto Interno Bruto (PIB) per cápita</a> para cada país.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creación de la columna GDP_PC (PIB per cápita en dólares)</span>
<span class="n">paises</span><span class="p">[</span><span class="s1">&#39;GDP_PC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">paises</span><span class="p">[</span><span class="s1">&#39;GDP_MD&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000000</span><span class="p">)</span> <span class="o">/</span> <span class="n">paises</span><span class="p">[</span><span class="s1">&#39;POP_EST&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Para modularizar el código, es conveniente crear una función que realice el cálculo del PIB per cápita.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pib_per_capita</span><span class="p">(</span><span class="n">pib</span><span class="p">,</span> <span class="n">poblacion</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retorna el PIB per cápita dados el PIB de un país (en millones de dólares) y su población.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">pib</span> <span class="o">*</span> <span class="mi">1000000</span><span class="p">)</span> <span class="o">/</span> <span class="n">poblacion</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creación de la columna GDP_PC (PIB per cápita en dólares)</span>
<span class="c1"># mediante la función pib_per_capita()</span>
<span class="n">paises</span><span class="p">[</span><span class="s1">&#39;GDP_PC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pib_per_capita</span><span class="p">(</span><span class="n">paises</span><span class="p">[</span><span class="s1">&#39;GDP_MD&#39;</span><span class="p">],</span> <span class="n">paises</span><span class="p">[</span><span class="s1">&#39;POP_EST&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Despliegue de la nueva columna</span>
<span class="n">paises</span><span class="p">[[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;GDP_MD&#39;</span><span class="p">,</span> <span class="s1">&#39;POP_EST&#39;</span><span class="p">,</span> <span class="s1">&#39;GDP_PC&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>GDP_MD</th>
      <th>POP_EST</th>
      <th>GDP_PC</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IDN</th>
      <td>Indonesia</td>
      <td>1119190</td>
      <td>270,625,568.00</td>
      <td>4,135.57</td>
    </tr>
    <tr>
      <th>MYS</th>
      <td>Malaysia</td>
      <td>364681</td>
      <td>31,949,777.00</td>
      <td>11,414.20</td>
    </tr>
    <tr>
      <th>CHL</th>
      <td>Chile</td>
      <td>282318</td>
      <td>18,952,038.00</td>
      <td>14,896.45</td>
    </tr>
    <tr>
      <th>BOL</th>
      <td>Bolivia</td>
      <td>40895</td>
      <td>11,513,100.00</td>
      <td>3,552.04</td>
    </tr>
    <tr>
      <th>PER</th>
      <td>Peru</td>
      <td>226848</td>
      <td>32,510,453.00</td>
      <td>6,977.69</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>NRU</th>
      <td>Nauru</td>
      <td>118</td>
      <td>12,581.00</td>
      <td>9,379.22</td>
    </tr>
    <tr>
      <th>FSM</th>
      <td>Micronesia</td>
      <td>401</td>
      <td>113,815.00</td>
      <td>3,523.26</td>
    </tr>
    <tr>
      <th>VUT</th>
      <td>Vanuatu</td>
      <td>934</td>
      <td>299,882.00</td>
      <td>3,114.56</td>
    </tr>
    <tr>
      <th>PLW</th>
      <td>Palau</td>
      <td>268</td>
      <td>18,008.00</td>
      <td>14,882.27</td>
    </tr>
    <tr>
      <th>BHR</th>
      <td>Bahrain</td>
      <td>38574</td>
      <td>1,641,172.00</td>
      <td>23,503.93</td>
    </tr>
  </tbody>
</table>
<p>201 rows × 4 columns</p>
</div></div></div>
</div>
</section>
<section id="ejemplo-idiomas-oficiales">
<h4>Ejemplo: idiomas oficiales<a class="headerlink" href="#ejemplo-idiomas-oficiales" title="Link to this heading">#</a></h4>
<p>Para crear una nueva columna llamada <code class="docutils literal notranslate"><span class="pre">LANGUAGES</span></code>, con los idiomas oficiales de cada país, se define una función llamada <code class="docutils literal notranslate"><span class="pre">obtener_idiomas_pais()</span></code>, la cual recibe como entrada el código <a class="reference external" href="https://es.wikipedia.org/wiki/ISO_3166-1_alfa-3">ISO 3166-1 alpha-3 (cca3)</a> del país (el cual se encuentra en el índice del dataframe <code class="docutils literal notranslate"><span class="pre">paises</span></code>) y consulta el API <a class="reference external" href="https://restcountries.com/">REST Countries</a> para retornar una hilera de texto con los nombres de los idiomas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="k">def</span> <span class="nf">obtener_idiomas_pais</span><span class="p">(</span><span class="n">cca3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtiene una cadena con la lista de lenguajes oficiales de un país dado su código cca3.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># URL del API REST Countries</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://restcountries.com/v3.1/alpha/</span><span class="si">{</span><span class="n">cca3</span><span class="si">}</span><span class="s1">&#39;</span>
    
    <span class="c1"># Respuesta del API a la solicitud</span>
    <span class="n">respuesta</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    
    <span class="c1"># Revisión de la respuesta</span>
    <span class="k">if</span> <span class="n">respuesta</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">datos</span> <span class="o">=</span> <span class="n">respuesta</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">datos</span> <span class="ow">and</span> <span class="s1">&#39;languages&#39;</span> <span class="ow">in</span> <span class="n">datos</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">lenguajes</span> <span class="o">=</span> <span class="n">datos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;languages&#39;</span><span class="p">]</span>
            <span class="n">lista_lenguajes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lenguajes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">return</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lista_lenguajes</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<p>Ahora, para crear o modificar la nueva columna <code class="docutils literal notranslate"><span class="pre">LANGUAGES</span></code>, se utiliza la función <a class="reference external" href="https://docs.python.org/3/library/functions.html#map">map()</a> de Python, la cual aplica una función a cada uno de los elementos de una estructura de datos iterable (ej. tuplas, listas, series, dataframes). En este caso, aplica la función <code class="docutils literal notranslate"><span class="pre">obtener_idiomas_pais()</span></code> al dataframe de países, recibiendo como entrada el índice del dataframe <code class="docutils literal notranslate"><span class="pre">paises</span></code> (<code class="docutils literal notranslate"><span class="pre">paises.index</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creación de la columna LANGUAGES mediante la función obtener_idiomas_pais()</span>
<span class="n">paises</span><span class="p">[</span><span class="s1">&#39;LANGUAGES&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paises</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">obtener_idiomas_pais</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">39</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Creación de la columna LANGUAGES mediante la función obtener_idiomas_pais()</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">paises</span><span class="p">[</span><span class="s1">&#39;LANGUAGES&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paises</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">obtener_idiomas_pais</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/pandas/core/indexes/base.py:6491,</span> in <span class="ni">Index.map</span><span class="nt">(self, mapper, na_action)</span>
<span class="g g-Whitespace">   </span><span class="mi">6455</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">6456</span><span class="sd"> Map values using an input mapping or function.</span>
<span class="g g-Whitespace">   </span><span class="mi">6457</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">6487</span><span class="sd"> Index([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], dtype=&#39;object&#39;)</span>
<span class="g g-Whitespace">   </span><span class="mi">6488</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">6489</span> <span class="kn">from</span> <span class="nn">pandas.core.indexes.multi</span> <span class="kn">import</span> <span class="n">MultiIndex</span>
<span class="ne">-&gt; </span><span class="mi">6491</span> <span class="n">new_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_values</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">na_action</span><span class="o">=</span><span class="n">na_action</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6493</span> <span class="c1"># we can return a MultiIndex</span>
<span class="g g-Whitespace">   </span><span class="mi">6494</span> <span class="k">if</span> <span class="n">new_values</span><span class="o">.</span><span class="n">size</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/pandas/core/base.py:921,</span> in <span class="ni">IndexOpsMixin._map_values</span><span class="nt">(self, mapper, na_action, convert)</span>
<span class="g g-Whitespace">    </span><span class="mi">918</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">ExtensionArray</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">919</span>     <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="n">na_action</span><span class="o">=</span><span class="n">na_action</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">921</span> <span class="k">return</span> <span class="n">algorithms</span><span class="o">.</span><span class="n">map_array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">mapper</span><span class="p">,</span> <span class="n">na_action</span><span class="o">=</span><span class="n">na_action</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="n">convert</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/pandas/core/algorithms.py:1743,</span> in <span class="ni">map_array</span><span class="nt">(arr, mapper, na_action, convert)</span>
<span class="g g-Whitespace">   </span><span class="mi">1741</span> <span class="n">values</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1742</span> <span class="k">if</span> <span class="n">na_action</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1743</span>     <span class="k">return</span> <span class="n">lib</span><span class="o">.</span><span class="n">map_infer</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">mapper</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="n">convert</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1744</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1745</span>     <span class="k">return</span> <span class="n">lib</span><span class="o">.</span><span class="n">map_infer_mask</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1746</span>         <span class="n">values</span><span class="p">,</span> <span class="n">mapper</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">isna</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span> <span class="n">convert</span><span class="o">=</span><span class="n">convert</span>
<span class="g g-Whitespace">   </span><span class="mi">1747</span>     <span class="p">)</span>

<span class="nn">File lib.pyx:2972,</span> in <span class="ni">pandas._libs.lib.map_infer</span><span class="nt">()</span>

<span class="nn">Cell In[38], line 12,</span> in <span class="ni">obtener_idiomas_pais</span><span class="nt">(cca3)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://restcountries.com/v3.1/alpha/</span><span class="si">{</span><span class="n">cca3</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="c1"># Respuesta del API a la solicitud</span>
<span class="ne">---&gt; </span><span class="mi">12</span> <span class="n">respuesta</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="c1"># Revisión de la respuesta</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="k">if</span> <span class="n">respuesta</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/requests/api.py:73,</span> in <span class="ni">get</span><span class="nt">(url, params, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span><span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sends a GET request.</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">65</span><span class="sd">     :param url: URL for the new :class:`Request` object.</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">     </span><span class="mi">70</span><span class="sd">     :rtype: requests.Response</span>
<span class="g g-Whitespace">     </span><span class="mi">71</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">73</span>     <span class="k">return</span> <span class="n">request</span><span class="p">(</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/requests/api.py:59,</span> in <span class="ni">request</span><span class="nt">(method, url, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="c1"># By using the &#39;with&#39; statement we are sure the session is closed, thus we</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span> <span class="c1"># avoid leaving sockets open which can trigger a ResourceWarning in some</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> <span class="c1"># cases, and look like a memory leak in others.</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span> <span class="k">with</span> <span class="n">sessions</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">59</span>     <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/requests/sessions.py:589,</span> in <span class="ni">Session.request</span><span class="nt">(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)</span>
<span class="g g-Whitespace">    </span><span class="mi">584</span> <span class="n">send_kwargs</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">585</span>     <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">586</span>     <span class="s2">&quot;allow_redirects&quot;</span><span class="p">:</span> <span class="n">allow_redirects</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span> <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">588</span> <span class="n">send_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">589</span> <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">prep</span><span class="p">,</span> <span class="o">**</span><span class="n">send_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span> <span class="k">return</span> <span class="n">resp</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/requests/sessions.py:703,</span> in <span class="ni">Session.send</span><span class="nt">(self, request, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span> <span class="n">start</span> <span class="o">=</span> <span class="n">preferred_clock</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span> <span class="c1"># Send the request</span>
<span class="ne">--&gt; </span><span class="mi">703</span> <span class="n">r</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span> <span class="c1"># Total elapsed time of the request (approximately)</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span> <span class="n">elapsed</span> <span class="o">=</span> <span class="n">preferred_clock</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/requests/adapters.py:667,</span> in <span class="ni">HTTPAdapter.send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">664</span>     <span class="n">timeout</span> <span class="o">=</span> <span class="n">TimeoutSauce</span><span class="p">(</span><span class="n">connect</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">read</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">666</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">667</span>     <span class="n">resp</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">668</span>         <span class="n">method</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">669</span>         <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">670</span>         <span class="n">body</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">671</span>         <span class="n">headers</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">672</span>         <span class="n">redirect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">673</span>         <span class="n">assert_same_host</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">674</span>         <span class="n">preload_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">675</span>         <span class="n">decode_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">676</span>         <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">677</span>         <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">678</span>         <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">679</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">681</span> <span class="k">except</span> <span class="p">(</span><span class="n">ProtocolError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">682</span>     <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/urllib3/connectionpool.py:789,</span> in <span class="ni">HTTPConnectionPool.urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, preload_content, decode_content, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">786</span> <span class="n">response_conn</span> <span class="o">=</span> <span class="n">conn</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">release_conn</span> <span class="k">else</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">788</span> <span class="c1"># Make the request on the HTTPConnection object</span>
<span class="ne">--&gt; </span><span class="mi">789</span> <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">790</span>     <span class="n">conn</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span>     <span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">792</span>     <span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">793</span>     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout_obj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>     <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span>     <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>     <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">797</span>     <span class="n">retries</span><span class="o">=</span><span class="n">retries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>     <span class="n">response_conn</span><span class="o">=</span><span class="n">response_conn</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">799</span>     <span class="n">preload_content</span><span class="o">=</span><span class="n">preload_content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">800</span>     <span class="n">decode_content</span><span class="o">=</span><span class="n">decode_content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">801</span>     <span class="o">**</span><span class="n">response_kw</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">802</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">804</span> <span class="c1"># Everything went great!</span>
<span class="g g-Whitespace">    </span><span class="mi">805</span> <span class="n">clean_exit</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/urllib3/connectionpool.py:466,</span> in <span class="ni">HTTPConnectionPool._make_request</span><span class="nt">(self, conn, method, url, body, headers, retries, timeout, chunked, response_conn, preload_content, decode_content, enforce_content_length)</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span>     <span class="c1"># Trigger any extra validation we need to do.</span>
<span class="g g-Whitespace">    </span><span class="mi">465</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">466</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_validate_conn</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">467</span>     <span class="k">except</span> <span class="p">(</span><span class="n">SocketTimeout</span><span class="p">,</span> <span class="n">BaseSSLError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">468</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_raise_timeout</span><span class="p">(</span><span class="n">err</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout_value</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/urllib3/connectionpool.py:1095,</span> in <span class="ni">HTTPSConnectionPool._validate_conn</span><span class="nt">(self, conn)</span>
<span class="g g-Whitespace">   </span><span class="mi">1093</span> <span class="c1"># Force connect early to allow us to validate the connection.</span>
<span class="g g-Whitespace">   </span><span class="mi">1094</span> <span class="k">if</span> <span class="n">conn</span><span class="o">.</span><span class="n">is_closed</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1095</span>     <span class="n">conn</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1097</span> <span class="c1"># TODO revise this, see https://github.com/urllib3/urllib3/issues/2791</span>
<span class="g g-Whitespace">   </span><span class="mi">1098</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">conn</span><span class="o">.</span><span class="n">is_verified</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">conn</span><span class="o">.</span><span class="n">proxy_is_verified</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/urllib3/connection.py:652,</span> in <span class="ni">HTTPSConnection.connect</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">649</span> <span class="c1"># Remove trailing &#39;.&#39; from fqdn hostnames to allow certificate validation</span>
<span class="g g-Whitespace">    </span><span class="mi">650</span> <span class="n">server_hostname_rm_dot</span> <span class="o">=</span> <span class="n">server_hostname</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">652</span> <span class="n">sock_and_verified</span> <span class="o">=</span> <span class="n">_ssl_wrap_socket_and_match_hostname</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">653</span>     <span class="n">sock</span><span class="o">=</span><span class="n">sock</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">654</span>     <span class="n">cert_reqs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert_reqs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">655</span>     <span class="n">ssl_version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_version</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">656</span>     <span class="n">ssl_minimum_version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_minimum_version</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">657</span>     <span class="n">ssl_maximum_version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_maximum_version</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">658</span>     <span class="n">ca_certs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_certs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">659</span>     <span class="n">ca_cert_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_cert_dir</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">660</span>     <span class="n">ca_cert_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_cert_data</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">661</span>     <span class="n">cert_file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert_file</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">662</span>     <span class="n">key_file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">key_file</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">663</span>     <span class="n">key_password</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">key_password</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">664</span>     <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname_rm_dot</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">665</span>     <span class="n">ssl_context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_context</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">666</span>     <span class="n">tls_in_tls</span><span class="o">=</span><span class="n">tls_in_tls</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">667</span>     <span class="n">assert_hostname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">assert_hostname</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">668</span>     <span class="n">assert_fingerprint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">assert_fingerprint</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">669</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">670</span> <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="n">sock_and_verified</span><span class="o">.</span><span class="n">socket</span>
<span class="g g-Whitespace">    </span><span class="mi">672</span> <span class="c1"># Forwarding proxies can never have a verified target since</span>
<span class="g g-Whitespace">    </span><span class="mi">673</span> <span class="c1"># the proxy is the one doing the verification. Should instead</span>
<span class="g g-Whitespace">    </span><span class="mi">674</span> <span class="c1"># use a CONNECT tunnel in order to verify the target.</span>
<span class="g g-Whitespace">    </span><span class="mi">675</span> <span class="c1"># See: https://github.com/urllib3/urllib3/issues/3267.</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/urllib3/connection.py:805,</span> in <span class="ni">_ssl_wrap_socket_and_match_hostname</span><span class="nt">(sock, cert_reqs, ssl_version, ssl_minimum_version, ssl_maximum_version, cert_file, key_file, key_password, ca_certs, ca_cert_dir, ca_cert_data, assert_hostname, assert_fingerprint, server_hostname, ssl_context, tls_in_tls)</span>
<span class="g g-Whitespace">    </span><span class="mi">802</span>     <span class="k">if</span> <span class="n">is_ipaddress</span><span class="p">(</span><span class="n">normalized</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">803</span>         <span class="n">server_hostname</span> <span class="o">=</span> <span class="n">normalized</span>
<span class="ne">--&gt; </span><span class="mi">805</span> <span class="n">ssl_sock</span> <span class="o">=</span> <span class="n">ssl_wrap_socket</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">806</span>     <span class="n">sock</span><span class="o">=</span><span class="n">sock</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">807</span>     <span class="n">keyfile</span><span class="o">=</span><span class="n">key_file</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">808</span>     <span class="n">certfile</span><span class="o">=</span><span class="n">cert_file</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">809</span>     <span class="n">key_password</span><span class="o">=</span><span class="n">key_password</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">810</span>     <span class="n">ca_certs</span><span class="o">=</span><span class="n">ca_certs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">811</span>     <span class="n">ca_cert_dir</span><span class="o">=</span><span class="n">ca_cert_dir</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span>     <span class="n">ca_cert_data</span><span class="o">=</span><span class="n">ca_cert_data</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">813</span>     <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">814</span>     <span class="n">ssl_context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">815</span>     <span class="n">tls_in_tls</span><span class="o">=</span><span class="n">tls_in_tls</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">816</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">818</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">819</span>     <span class="k">if</span> <span class="n">assert_fingerprint</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/urllib3/util/ssl_.py:465,</span> in <span class="ni">ssl_wrap_socket</span><span class="nt">(sock, keyfile, certfile, cert_reqs, ca_certs, server_hostname, ssl_version, ciphers, ssl_context, ca_cert_dir, key_password, ca_cert_data, tls_in_tls)</span>
<span class="g g-Whitespace">    </span><span class="mi">462</span> <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>  <span class="c1"># Defensive: in CI, we always have set_alpn_protocols</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span>     <span class="k">pass</span>
<span class="ne">--&gt; </span><span class="mi">465</span> <span class="n">ssl_sock</span> <span class="o">=</span> <span class="n">_ssl_wrap_socket_impl</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">tls_in_tls</span><span class="p">,</span> <span class="n">server_hostname</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">466</span> <span class="k">return</span> <span class="n">ssl_sock</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/site-packages/urllib3/util/ssl_.py:509,</span> in <span class="ni">_ssl_wrap_socket_impl</span><span class="nt">(sock, ssl_context, tls_in_tls, server_hostname)</span>
<span class="g g-Whitespace">    </span><span class="mi">506</span>     <span class="n">SSLTransport</span><span class="o">.</span><span class="n">_validate_ssl_context_for_tls_in_tls</span><span class="p">(</span><span class="n">ssl_context</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">507</span>     <span class="k">return</span> <span class="n">SSLTransport</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">ssl_context</span><span class="p">,</span> <span class="n">server_hostname</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">509</span> <span class="k">return</span> <span class="n">ssl_context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/ssl.py:455,</span> in <span class="ni">SSLContext.wrap_socket</span><span class="nt">(self, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, session)</span>
<span class="g g-Whitespace">    </span><span class="mi">449</span> <span class="k">def</span> <span class="nf">wrap_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sock</span><span class="p">,</span> <span class="n">server_side</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span>                 <span class="n">do_handshake_on_connect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span>                 <span class="n">suppress_ragged_eofs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">452</span>                 <span class="n">server_hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">453</span>     <span class="c1"># SSLSocket class handles server_hostname encoding before it calls</span>
<span class="g g-Whitespace">    </span><span class="mi">454</span>     <span class="c1"># ctx._wrap_socket()</span>
<span class="ne">--&gt; </span><span class="mi">455</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sslsocket_class</span><span class="o">.</span><span class="n">_create</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">456</span>         <span class="n">sock</span><span class="o">=</span><span class="n">sock</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">457</span>         <span class="n">server_side</span><span class="o">=</span><span class="n">server_side</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span>         <span class="n">do_handshake_on_connect</span><span class="o">=</span><span class="n">do_handshake_on_connect</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span>         <span class="n">suppress_ragged_eofs</span><span class="o">=</span><span class="n">suppress_ragged_eofs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span>         <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span>         <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">462</span>         <span class="n">session</span><span class="o">=</span><span class="n">session</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span>     <span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/ssl.py:1042,</span> in <span class="ni">SSLSocket._create</span><span class="nt">(cls, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, context, session)</span>
<span class="g g-Whitespace">   </span><span class="mi">1039</span>             <span class="k">if</span> <span class="n">timeout</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1040</span>                 <span class="c1"># non-blocking</span>
<span class="g g-Whitespace">   </span><span class="mi">1041</span>                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;do_handshake_on_connect should not be specified for non-blocking sockets&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1042</span>             <span class="bp">self</span><span class="o">.</span><span class="n">do_handshake</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1043</span> <span class="k">except</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1044</span>     <span class="k">try</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/gf0657-2024-ii/lib/python3.12/ssl.py:1320,</span> in <span class="ni">SSLSocket.do_handshake</span><span class="nt">(self, block)</span>
<span class="g g-Whitespace">   </span><span class="mi">1318</span>     <span class="k">if</span> <span class="n">timeout</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">block</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1319</span>         <span class="bp">self</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1320</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">do_handshake</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1321</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1322</span>     <span class="bp">self</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Despliegue de la nueva columna</span>
<span class="n">paises</span><span class="p">[[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;LANGUAGES&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>LANGUAGES</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>IDN</th>
      <td>Indonesia</td>
      <td>Indonesian</td>
    </tr>
    <tr>
      <th>MYS</th>
      <td>Malaysia</td>
      <td>English, Malay</td>
    </tr>
    <tr>
      <th>CHL</th>
      <td>Chile</td>
      <td>Spanish</td>
    </tr>
    <tr>
      <th>BOL</th>
      <td>Bolivia</td>
      <td>Aymara, Guaraní, Quechua, Spanish</td>
    </tr>
    <tr>
      <th>PER</th>
      <td>Peru</td>
      <td>Aymara, Quechua, Spanish</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>NRU</th>
      <td>Nauru</td>
      <td>English, Nauru</td>
    </tr>
    <tr>
      <th>FSM</th>
      <td>Micronesia</td>
      <td>English</td>
    </tr>
    <tr>
      <th>VUT</th>
      <td>Vanuatu</td>
      <td>Bislama, English, French</td>
    </tr>
    <tr>
      <th>PLW</th>
      <td>Palau</td>
      <td>English, Palauan</td>
    </tr>
    <tr>
      <th>BHR</th>
      <td>Bahrain</td>
      <td>Arabic</td>
    </tr>
  </tbody>
</table>
<p>201 rows × 2 columns</p>
</div></div></div>
</div>
<p><strong>Ejercicios</strong></p>
<ol class="arabic simple">
<li><p>Defina una función llamada <code class="docutils literal notranslate"><span class="pre">obtener_capital_pais()</span></code> que reciba el código cca3 de un país y retorne su capital mediante una consulta al API REST Countries. Utilíce esta función para crear en el dataframe <code class="docutils literal notranslate"><span class="pre">paises</span></code> una nueva columna llamada <code class="docutils literal notranslate"><span class="pre">CAPITAL</span></code>, con la ciudad capital de cada país.</p></li>
</ol>
</section>
</section>
<section id="agrupacion-y-agregacion">
<h3>Agrupación y agregación<a class="headerlink" href="#agrupacion-y-agregacion" title="Link to this heading">#</a></h3>
<p>El proceso de agrupación y agregación consiste en dividir un conjunto de datos en grupos basados en uno o más criterios, para luego realizar operaciones en cada grupo. En pandas, este proceso se realiza mediante el método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html">pandas.DataFrame.groupby()</a>.</p>
<p>Por ejemplo, el dataframe de países puede agruparse por continente para calcular en cada uno la suma de la población.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Suma de población por continente</span>
<span class="n">suma_poblacion_por_continente</span> <span class="o">=</span> <span class="n">paises</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;CONTINENT&#39;</span><span class="p">)[</span><span class="s1">&#39;POP_EST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Despliegue de los resultados, ordenados descendentemente por población</span>
<span class="n">suma_poblacion_por_continente</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CONTINENT
Asia                      4,562,304,603.00
Africa                    1,307,986,092.30
Europe                      747,708,092.00
North America               584,776,221.00
South America               427,063,263.00
Oceania                      41,589,500.00
Seven seas (open ocean)       1,894,289.00
Antarctica                        4,490.00
Name: POP_EST, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>El argumento de <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> es usualmente una columna categórica (ej. <code class="docutils literal notranslate"><span class="pre">CONTINENT</span></code>) cuyos valores pasan a ser los grupos. En cada grupo se aplica una función de agregación (ej. <code class="docutils literal notranslate"><span class="pre">sum()</span></code>) para los valores de una columna numérica (ej. <code class="docutils literal notranslate"><span class="pre">POP_EST</span></code>).</p>
<p>Algunas funciones comunes de agregación son:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sum()</span></code>: suma.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mean()</span></code>: promedio.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">count()</span></code>: número de elementos.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max()</span></code>, <code class="docutils literal notranslate"><span class="pre">min()</span></code>: valores máximo y mínimo.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">median()</span></code>: mediana.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std()</span></code>: desviación estándar.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agg()</span></code>: para aplicar múltiples funciones o funciones personalizadas.</p></li>
</ul>
<p>El métoddo <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> permite agrupar también por múltiples columnas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Suma de población por región y subregión de la ONU</span>
<span class="n">suma_poblacion_por_region_subregion</span> <span class="o">=</span> <span class="n">paises</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;REGION_UN&#39;</span><span class="p">,</span> <span class="s1">&#39;SUBREGION&#39;</span><span class="p">])[</span><span class="s1">&#39;POP_EST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">suma_poblacion_por_region_subregion</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>REGION_UN   SUBREGION                
Africa      Eastern Africa                435,175,445.30
            Middle Africa                 174,308,432.00
            Northern Africa               241,801,558.00
            Southern Africa                66,629,895.00
            Western Africa                391,434,098.00
Americas    Caribbean                      38,982,419.00
            Central America               176,609,080.00
            Northern America              369,184,722.00
            South America                 427,063,263.00
Antarctica  Antarctica                          4,490.00
Asia        Central Asia                   73,814,587.00
            Eastern Asia                1,636,296,580.00
            South-Eastern Asia            661,911,038.00
            Southern Asia               1,918,690,648.00
            Western Asia                  272,122,703.00
Europe      Eastern Europe                291,080,093.00
            Northern Europe               105,802,448.00
            Southern Europe               152,729,852.00
            Western Europe                198,095,699.00
Oceania     Australia and New Zealand      30,319,695.00
            Melanesia                      10,635,767.00
            Micronesia                        320,801.00
            Polynesia                         313,237.00
Name: POP_EST, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>También es posible aplicar múltiples funciones de agregación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Suma y promedio de población por región y subregión de la ONU</span>
<span class="n">suma_promedio_poblacion_por_region_subregion</span> <span class="o">=</span> <span class="n">paises</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;REGION_UN&#39;</span><span class="p">,</span> <span class="s1">&#39;SUBREGION&#39;</span><span class="p">])[</span><span class="s1">&#39;POP_EST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">])</span>

<span class="n">suma_promedio_poblacion_por_region_subregion</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>sum</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Africa</th>
      <th>Eastern Africa</th>
      <td>435,175,445.30</td>
      <td>22,903,970.81</td>
    </tr>
    <tr>
      <th>Middle Africa</th>
      <td>174,308,432.00</td>
      <td>19,367,603.56</td>
    </tr>
    <tr>
      <th>Northern Africa</th>
      <td>241,801,558.00</td>
      <td>34,543,079.71</td>
    </tr>
    <tr>
      <th>Southern Africa</th>
      <td>66,629,895.00</td>
      <td>13,325,979.00</td>
    </tr>
    <tr>
      <th>Western Africa</th>
      <td>391,434,098.00</td>
      <td>24,464,631.12</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Americas</th>
      <th>Caribbean</th>
      <td>38,982,419.00</td>
      <td>2,998,647.62</td>
    </tr>
    <tr>
      <th>Central America</th>
      <td>176,609,080.00</td>
      <td>22,076,135.00</td>
    </tr>
    <tr>
      <th>Northern America</th>
      <td>369,184,722.00</td>
      <td>184,592,361.00</td>
    </tr>
    <tr>
      <th>South America</th>
      <td>427,063,263.00</td>
      <td>35,588,605.25</td>
    </tr>
    <tr>
      <th>Antarctica</th>
      <th>Antarctica</th>
      <td>4,490.00</td>
      <td>4,490.00</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">Asia</th>
      <th>Central Asia</th>
      <td>73,814,587.00</td>
      <td>14,762,917.40</td>
    </tr>
    <tr>
      <th>Eastern Asia</th>
      <td>1,636,296,580.00</td>
      <td>272,716,096.67</td>
    </tr>
    <tr>
      <th>South-Eastern Asia</th>
      <td>661,911,038.00</td>
      <td>60,173,730.73</td>
    </tr>
    <tr>
      <th>Southern Asia</th>
      <td>1,918,690,648.00</td>
      <td>213,187,849.78</td>
    </tr>
    <tr>
      <th>Western Asia</th>
      <td>272,122,703.00</td>
      <td>14,322,247.53</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Europe</th>
      <th>Eastern Europe</th>
      <td>291,080,093.00</td>
      <td>29,108,009.30</td>
    </tr>
    <tr>
      <th>Northern Europe</th>
      <td>105,802,448.00</td>
      <td>10,580,244.80</td>
    </tr>
    <tr>
      <th>Southern Europe</th>
      <td>152,729,852.00</td>
      <td>9,545,615.75</td>
    </tr>
    <tr>
      <th>Western Europe</th>
      <td>198,095,699.00</td>
      <td>22,010,633.22</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Oceania</th>
      <th>Australia and New Zealand</th>
      <td>30,319,695.00</td>
      <td>15,159,847.50</td>
    </tr>
    <tr>
      <th>Melanesia</th>
      <td>10,635,767.00</td>
      <td>2,658,941.75</td>
    </tr>
    <tr>
      <th>Micronesia</th>
      <td>320,801.00</td>
      <td>64,160.20</td>
    </tr>
    <tr>
      <th>Polynesia</th>
      <td>313,237.00</td>
      <td>104,412.33</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Ejercicios</strong></p>
<ol class="arabic simple">
<li><p>Calcule el promedio del PIB (<code class="docutils literal notranslate"><span class="pre">GDP_MD</span></code>) por continente. Muestre los resultados por orden alfabético de continente.</p></li>
<li><p>Calcule la suma y el promedio del PIB (<code class="docutils literal notranslate"><span class="pre">GDP_MD</span></code>) por continente. Muestre los resultados por orden descendente de suma del PIB.</p></li>
<li><p>Calcule el promedio del PIB (<code class="docutils literal notranslate"><span class="pre">GDP_MD</span></code>) por grupo de ingresos (<code class="docutils literal notranslate"><span class="pre">INCOME_GRP</span></code>). Muestre los resultados en orden descendente de promedio del PIB.</p></li>
<li><p>Calcule el promedio del PIB (<code class="docutils literal notranslate"><span class="pre">GDP_MD</span></code>) para las subregiones de las regiones de la ONU del continente americano. Muestre los resultados en orden descendente de promedio del PIB.</p></li>
</ol>
</section>
<section id="union-join">
<h3>Unión (<em>join</em>)<a class="headerlink" href="#union-join" title="Link to this heading">#</a></h3>
<p>La unión (en inglés, <em>join</em>) de datos ubicados en diferentes fuentes (ej. diferentes archivos) es una tarea común en análisis de información. Las uniones pueden ser de filas, columnas o de ambas. Usualmente, este tipo de operaciones se realiza con base en columnas que son comunes en los conjuntos de datos que se desea unir. A estas columnas se les llama “llaves” o “claves” (en inglés, <em>keys</em>).</p>
<p>Hay varios tipos de uniones de datos:</p>
<ul class="simple">
<li><p><em><strong>Left join</strong></em>: mantiene todas las filas del conjunto de datos del lado izquierdo y les agrega las columnas del conjunto de datos del lado derecho, en las filas en las que hay coincidencia en las llaves.</p></li>
<li><p><em><strong>Right join</strong></em>: mantiene todas las filas del conjunto de datos del lado derecho y agrega las columnas del conjunto de datos del lado izquierdo, en las filas en las que hay coincidencia en las llaves.</p></li>
<li><p><em><strong>Inner join</strong></em>: incluye las filas que coinciden en ambos conjuntos de datos.</p></li>
<li><p><em><strong>Full join</strong></em>: incluye todas las filas de ambos conjuntos de datos.</p></li>
</ul>
<p>Los diferentes tipos de unión se ilustran en la <a class="reference internal" href="#figure-tipos-join"><span class="std std-numref">Fig. 24</span></a> mediante diagramas de Venn.</p>
<figure class="align-default" id="figure-tipos-join">
<img alt="../../_images/join.jpg" src="../../_images/join.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">Tipos de uniones de datos. Imagen de <a class="reference external" href="https://www.hostingplus.com.co/blog/tipos-de-join-en-sql-cuales-son-los-principales/">hostingplus</a>.</span><a class="headerlink" href="#figure-tipos-join" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>La biblioteca pandas incluye varios métodos para unir series y dataframes:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.merge()</span></code></a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.join()</span></code></a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html"><code class="docutils literal notranslate"><span class="pre">pandas.concat()</span></code></a></p></li>
</ul>
<p>Para ejemplificar el concepto de unión de datos, al dataframe <code class="docutils literal notranslate"><span class="pre">paises</span></code> se le agregará una columna correspondiente a la <a class="reference external" href="https://es.wikipedia.org/wiki/Esperanza_de_vida">esperanza de vida al nacer</a> en cada país. Esta columna proviene de los datos de <a class="reference external" href="https://datos.bancomundial.org/indicador">indicadores del Banco Mundial</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Carga de datos de esperanza de vida al nacer por país</span>

<span class="n">esperanza_vida</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/gf0657-programacionsig/2024-ii/refs/heads/main/datos/world-bank/paises-esperanza-vida.csv&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>El archivo CSV del Banco Mundial tiene más de 60 columnas. Para simplificar el análisis, se conservan solamente las columnas <code class="docutils literal notranslate"><span class="pre">Country</span> <span class="pre">Code</span></code> (código cca3) y <code class="docutils literal notranslate"><span class="pre">2022</span></code> (esperanza de vida al nacer en 2022). La primera se utiliza como índice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reducción de columnas de esperanza_vida</span>
<span class="n">esperanza_vida</span> <span class="o">=</span> <span class="n">esperanza_vida</span><span class="p">[[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">,</span> <span class="s1">&#39;2022&#39;</span><span class="p">]]</span>

<span class="c1"># Se usa la columna &#39;Country Code&#39; como índice</span>
<span class="n">esperanza_vida</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Country Code&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Muestra de los datos</span>
<span class="n">esperanza_vida</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2022</th>
    </tr>
    <tr>
      <th>Country Code</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PYF</th>
      <td>83.55</td>
    </tr>
    <tr>
      <th>TSA</th>
      <td>68.16</td>
    </tr>
    <tr>
      <th>XKX</th>
      <td>79.52</td>
    </tr>
    <tr>
      <th>SAU</th>
      <td>77.91</td>
    </tr>
    <tr>
      <th>CZE</th>
      <td>79.03</td>
    </tr>
    <tr>
      <th>MLT</th>
      <td>82.70</td>
    </tr>
    <tr>
      <th>SSF</th>
      <td>60.76</td>
    </tr>
    <tr>
      <th>VCT</th>
      <td>68.97</td>
    </tr>
    <tr>
      <th>BGD</th>
      <td>73.70</td>
    </tr>
    <tr>
      <th>MAR</th>
      <td>74.97</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Seguidamente, se utiliza el método <code class="docutils literal notranslate"><span class="pre">pandas.Dataframe.join()</span></code> para unir <code class="docutils literal notranslate"><span class="pre">paises</span></code> con <code class="docutils literal notranslate"><span class="pre">paises_esperanza_vida</span></code>. Se elige este método debido a que su sintaxis es muy sencilla cuando las llaves de ambos dataframes con los índices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unión de los dataframes paises y esperanza_vida</span>
<span class="n">paises</span> <span class="o">=</span> <span class="n">paises</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">esperanza_vida</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>En este caso <code class="docutils literal notranslate"><span class="pre">paises</span></code> es el conjunto del “lado izquierdo” y <code class="docutils literal notranslate"><span class="pre">esperanza_vida</span></code> el del “lado derecho”. El argumento <code class="docutils literal notranslate"><span class="pre">how=&quot;left&quot;</span></code> indica que se está realizando un <em>left join</em>, por lo que se conservan todas las filas del conjunto de lado izquierdo. Si el código cca3 de algún país de <code class="docutils literal notranslate"><span class="pre">países</span></code> no está en <code class="docutils literal notranslate"><span class="pre">esperanza_vida</span></code>, la columna unida tendrá un valor nulo.</p>
<p>La nueva columna se renombra con el método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rename.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.rename()</span></code></a>, para que sea similar a las otras.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cambio de nombre de la nueva columna</span>

<span class="n">paises</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;2022&#39;</span><span class="p">:</span> <span class="s1">&#39;LIFE_EXPECTANCY&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Muestra aleatoria de 10 filas</span>
<span class="n">paises</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>REGION_UN</th>
      <th>SUBREGION</th>
      <th>REGION_WB</th>
      <th>ECONOMY</th>
      <th>INCOME_GRP</th>
      <th>POP_EST</th>
      <th>GDP_MD</th>
      <th>GDP_PC</th>
      <th>LANGUAGES</th>
      <th>LIFE_EXPECTANCY</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>EGY</th>
      <td>Egypt</td>
      <td>Africa</td>
      <td>Africa</td>
      <td>Northern Africa</td>
      <td>Middle East &amp; North Africa</td>
      <td>5. Emerging region: G20</td>
      <td>4. Lower middle income</td>
      <td>100,388,073.00</td>
      <td>303092</td>
      <td>3,019.20</td>
      <td>Arabic</td>
      <td>70.16</td>
    </tr>
    <tr>
      <th>SLB</th>
      <td>Solomon Is.</td>
      <td>Oceania</td>
      <td>Oceania</td>
      <td>Melanesia</td>
      <td>East Asia &amp; Pacific</td>
      <td>7. Least developed region</td>
      <td>4. Lower middle income</td>
      <td>669,823.00</td>
      <td>1589</td>
      <td>2,372.27</td>
      <td>English</td>
      <td>70.74</td>
    </tr>
    <tr>
      <th>ATA</th>
      <td>Antarctica</td>
      <td>Antarctica</td>
      <td>Antarctica</td>
      <td>Antarctica</td>
      <td>Antarctica</td>
      <td>6. Developing region</td>
      <td>2. High income: nonOECD</td>
      <td>4,490.00</td>
      <td>898</td>
      <td>200,000.00</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>BGR</th>
      <td>Bulgaria</td>
      <td>Europe</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Europe &amp; Central Asia</td>
      <td>2. Developed region: nonG7</td>
      <td>3. Upper middle income</td>
      <td>6,975,761.00</td>
      <td>68558</td>
      <td>9,828.03</td>
      <td>Bulgarian</td>
      <td>74.36</td>
    </tr>
    <tr>
      <th>CRI</th>
      <td>Costa Rica</td>
      <td>North America</td>
      <td>Americas</td>
      <td>Central America</td>
      <td>Latin America &amp; Caribbean</td>
      <td>5. Emerging region: G20</td>
      <td>3. Upper middle income</td>
      <td>5,047,561.00</td>
      <td>61801</td>
      <td>12,243.74</td>
      <td>Spanish</td>
      <td>77.32</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Países con esperanza de vida más alta</span>
<span class="n">paises</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;LIFE_EXPECTANCY&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)[[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;CONTINENT&#39;</span><span class="p">,</span> <span class="s1">&#39;LIFE_EXPECTANCY&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>LIFE_EXPECTANCY</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>LIE</th>
      <td>Liechtenstein</td>
      <td>Europe</td>
      <td>84.32</td>
    </tr>
    <tr>
      <th>JPN</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>84.00</td>
    </tr>
    <tr>
      <th>CHE</th>
      <td>Switzerland</td>
      <td>Europe</td>
      <td>83.45</td>
    </tr>
    <tr>
      <th>AUS</th>
      <td>Australia</td>
      <td>Oceania</td>
      <td>83.20</td>
    </tr>
    <tr>
      <th>SWE</th>
      <td>Sweden</td>
      <td>Europe</td>
      <td>83.11</td>
    </tr>
    <tr>
      <th>ESP</th>
      <td>Spain</td>
      <td>Europe</td>
      <td>83.08</td>
    </tr>
    <tr>
      <th>IRL</th>
      <td>Ireland</td>
      <td>Europe</td>
      <td>83.06</td>
    </tr>
    <tr>
      <th>LUX</th>
      <td>Luxembourg</td>
      <td>Europe</td>
      <td>83.05</td>
    </tr>
    <tr>
      <th>ITA</th>
      <td>Italy</td>
      <td>Europe</td>
      <td>82.90</td>
    </tr>
    <tr>
      <th>SGP</th>
      <td>Singapore</td>
      <td>Asia</td>
      <td>82.90</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Países con esperanza de vida más baja</span>
<span class="n">paises</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;LIFE_EXPECTANCY&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)[[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;CONTINENT&#39;</span><span class="p">,</span> <span class="s1">&#39;LIFE_EXPECTANCY&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>CONTINENT</th>
      <th>LIFE_EXPECTANCY</th>
    </tr>
    <tr>
      <th>ADM0_ISO</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TCD</th>
      <td>Chad</td>
      <td>Africa</td>
      <td>53.00</td>
    </tr>
    <tr>
      <th>LSO</th>
      <td>Lesotho</td>
      <td>Africa</td>
      <td>53.04</td>
    </tr>
    <tr>
      <th>NGA</th>
      <td>Nigeria</td>
      <td>Africa</td>
      <td>53.63</td>
    </tr>
    <tr>
      <th>CAF</th>
      <td>Central African Rep.</td>
      <td>Africa</td>
      <td>54.48</td>
    </tr>
    <tr>
      <th>SSD</th>
      <td>S. Sudan</td>
      <td>Africa</td>
      <td>55.57</td>
    </tr>
    <tr>
      <th>SOM</th>
      <td>Somaliland</td>
      <td>Africa</td>
      <td>56.11</td>
    </tr>
    <tr>
      <th>SOM</th>
      <td>Somalia</td>
      <td>Africa</td>
      <td>56.11</td>
    </tr>
    <tr>
      <th>SWZ</th>
      <td>eSwatini</td>
      <td>Africa</td>
      <td>56.36</td>
    </tr>
    <tr>
      <th>NAM</th>
      <td>Namibia</td>
      <td>Africa</td>
      <td>58.06</td>
    </tr>
    <tr>
      <th>CIV</th>
      <td>Côte d'Ivoire</td>
      <td>Africa</td>
      <td>58.92</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Ejercicios</strong></p>
<ol class="arabic simple">
<li><p>Mediante uniones de datos, agregue al dataframe <code class="docutils literal notranslate"><span class="pre">paises</span></code> columnas correspondientes a:</p></li>
</ol>
<ul class="simple">
<li><p>Tasa de alfabetización de adultos.</p></li>
<li><p>Tasa de mortalidad infantil.</p></li>
</ul>
<p>Busque los archivos de datos necesarios en <a class="reference external" href="https://datos.bancomundial.org/indicador">Banco Mundial - Datos de indicadores</a>. <strong>Sugerencia</strong>: con un editor de texto (ej. VS Code) elimine las filas que no forman parte del formato CSV en la parte superior de los archivos.</p>
</section>
<section id="exportacion">
<h3>Exportación<a class="headerlink" href="#exportacion" title="Link to this heading">#</a></h3>
<p>pandas proporciona varios métodos para exportar dataframes a otros formatos. Por ejemplo, el método <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_csv.html"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.to_csv()</span></code></a> exporta un dataframe a un archivo de valores separados por comas (CSV). Otros métodos similares pueden exportar a otros formatos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exportación al formato CSV</span>
<span class="n">paises</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;paises-ampliado.csv&#39;</span><span class="p">)</span>

<span class="c1"># Exportación al formato JSON</span>
<span class="n">paises</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;paises-ampliado.json&#39;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="recursos-de-interes">
<h2>Recursos de interés<a class="headerlink" href="#recursos-de-interes" title="Link to this heading">#</a></h2>
<p><em>Banco Mundial - Datos de indicadores</em>. (s. f.). Recuperado 6 de octubre de 2024, de <a class="reference external" href="https://datos.bancomundial.org/indicador">https://datos.bancomundial.org/indicador</a></p>
<p><em>Natural Earth - Free vector and raster map data</em>. (s. f.). Recuperado 6 de octubre de 2024, de <a class="reference external" href="https://www.naturalearthdata.com/">https://www.naturalearthdata.com/</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "gf0657-programacionsig/2024-ii",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./contenido/3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../2/api.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Interfaces de programación de aplicaciones (API)</p>
      </div>
    </a>
    <a class="right-next"
       href="matplotlib.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">matplotlib: biblioteca para visualización de datos</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">Introducción</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga">Carga</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuracion">Configuración</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estructuras-de-datos">Estructuras de datos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#series">Series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframes">Dataframes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operaciones-basicas">Operaciones básicas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-datos">Carga de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#obtencion-de-informacion-general">Obtención de información general</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#funciones-basicas-de-recuperacion-y-despliegue-de-datos">Funciones básicas de recuperación y despliegue de datos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#head-primeras-filas"><code class="docutils literal notranslate"><span class="pre">head()</span></code> - primeras filas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tail-ultimas-filas"><code class="docutils literal notranslate"><span class="pre">tail()</span></code> - últimas filas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-muestra-aleatoria-de-filas"><code class="docutils literal notranslate"><span class="pre">sample()</span></code> - muestra aleatoria de filas</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creacion-de-subconjuntos">Creación de subconjuntos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mediante-indices-numericos">Mediante índices numéricos</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mediante-etiquetas">Mediante etiquetas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mediante-expresiones-logicas">Mediante expresiones lógicas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-head-tail-y-sample">Métodos <code class="docutils literal notranslate"><span class="pre">head()</span></code>, <code class="docutils literal notranslate"><span class="pre">tail()</span></code> y <code class="docutils literal notranslate"><span class="pre">sample()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ordenamiento">Ordenamiento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creacion-y-modificacion-de-columnas">Creación y modificación de columnas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-pib-per-capita">Ejemplo: PIB per cápita</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-idiomas-oficiales">Ejemplo: idiomas oficiales</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupacion-y-agregacion">Agrupación y agregación</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#union-join">Unión (<em>join</em>)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exportacion">Exportación</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recursos-de-interes">Recursos de interés</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Manuel Vargas
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>